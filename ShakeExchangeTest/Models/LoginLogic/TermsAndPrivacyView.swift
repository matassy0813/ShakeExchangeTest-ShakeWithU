//
//  TermsAndPrivacyView.swift
//  ShakeExchangeTest
//
//  Created by 俣江悠聖 on 2025/07/11.
//

import SwiftUI
import MarkdownUI

enum DocumentType {
    case terms
    case privacy

    var title: String {
        switch self {
        case .terms: return "利用規約"
        case .privacy: return "プライバシーポリシー"
        }
    }

    var content: String {
        switch self {
        case .terms:
            return """
            ## ShakeWith-U 利用規約

            本利用規約（以下「本規約」といいます）は、0kaka（以下「当社」といいます）が提供するスマートフォンアプリケーション「ShakeWith-U」（以下「本アプリ」といいます）の利用に関する条件を定めるものです。本アプリをご利用になるお客様（以下「ユーザー」といいます）は、本規約のすべてに同意した上で、本アプリをご利用ください。

            ---

            ### 第1条（本規約の適用）
            1. 本規約は、本アプリの利用に関する当社とユーザーとのすべての関係に適用されます。
            2. ユーザーが本アプリを利用した場合、本規約に同意したものとみなされます。
            3. 当社は必要に応じて本規約を改定することがあります。改定時には本アプリ内または当社ウェブサイトにて通知し、当該通知時点から効力を生じるものとします。

            ---

            ### 第2条（利用資格）
            1. 本アプリは、13歳以上のユーザーのみが利用できます。13歳未満の方は、保護者の同意がある場合を除き、本アプリを利用することはできません。
            2. 未成年者が利用する場合は、保護者の同意を得た上でご利用ください。

            ---

            ### 第3条（ユーザー登録）
            1. 本アプリの一部機能の利用には、当社所定の方法によるユーザー登録が必要です。
            2. 登録時には、Firebase Authentication によりユーザー認証を行います。
            3. ユーザーは、登録情報（メールアドレス、ニックネームなど）を正確に管理し、不正利用や端末紛失等があった場合は速やかに当社に連絡してください。
            4. 複数アカウントの不正作成は禁止します。

            ---

            ### 第4条（禁止事項）
            ユーザーは、以下の行為を行ってはなりません：
            - 法令または公序良俗に反する行為
            - 他のユーザーまたは第三者への誹謗中傷、差別、ハラスメント等の行為
            - 他人の著作権、商標権、肖像権、プライバシーなどの権利を侵害する行為
            - 本アプリの運営を妨害する行為（スパム、過負荷、逆コンパイル等を含む）
            - 本人以外のなりすまし、虚偽の情報による登録
            - 商業目的の利用（当社の事前承諾がある場合を除く）
            - 自動投稿・不正なバッジ取得・アルゴリズム操作を目的とした行為
            - その他当社が不適切と判断する行為

            ---

            ### 第5条（ユーザーコンテンツ）
            1. ユーザーがアプリ上で投稿・アップロードするテキスト、画像、ニックネーム等のコンテンツ（以下「ユーザーコンテンツ」）の著作権はユーザーに帰属します。
            2. ユーザーは、当社に対して、当該ユーザーコンテンツを本アプリ内およびプロモーション等で無償で使用する非独占的かつ全世界的な権利を許諾するものとします。
            3. 当社は、ユーザーコンテンツが不適切であると判断した場合、通知なく削除できるものとします。
            4. ユーザーは、投稿に関して第三者の著作権・プライバシー等の法令に違反していないことを保証するものとします。

            ---

            ### 第6条（知的財産権）
            1. 本アプリに含まれるコンテンツ、ソースコード、デザイン、UI、ロゴ、テキスト等のすべての知的財産権は当社に帰属します。
            2. ユーザーは、当社の明示的な許可なく、当該知的財産を複製、転載、販売、翻案、リバースエンジニアリング等してはなりません。

            ---

            ### 第7条（サービスの変更・中断・終了）
            1. 当社は、ユーザーへの事前通知なしに、本アプリの内容を変更、停止、または終了することができます。
            2. 災害・通信障害・保守・法令変更等により、本アプリの一部または全部を停止することがあります。
            3. 当社は、これらによってユーザーに生じたいかなる損害についても責任を負いません。

            ---

            ### 第8条（免責事項）
            1. 本アプリでは、ユーザーがShake機能や写真の送受信を通じて、他ユーザーと対面・交流を行うことがあります。これらの行為はすべてユーザー自身の責任で行うものとし、当社は一切の責任を負いません。
            2. 本アプリの内容や機能は現状有姿で提供され、当社はその正確性・有用性・安全性等について保証しません。
            3. ユーザーによる本アプリの利用に起因して生じた損害について、当社は一切の責任を負いません。ただし、当社の故意または重過失による場合を除きます。
            4. ユーザー間またはユーザーと第三者間で生じたトラブルについて、当社は一切関与せず、責任を負いません。

            ---

            ### 第9条（個人情報の取り扱い）
            個人情報の取り扱いについては、別途定める「プライバシーポリシー」に従います。

            ---

            ### 第10条（利用契約の終了）
            1. ユーザーは、いつでもアカウントを削除することで、本アプリの利用契約を終了できます。
            2. 当社は、ユーザーが本規約に違反したと判断した場合、事前の通知なしに当該ユーザーの利用を停止・終了できるものとします。

            ---

            ### 第11条（利用制限・アカウント停止）
            当社は、以下に該当すると判断した場合、ユーザーのアカウントを停止・制限・削除できるものとします：
            - 他人のプライバシーを侵害する行為
            - 他ユーザーへの嫌がらせや誹謗中傷
            - その他、著しい規約違反と当社が認めた場合

            ---

            ### 第12条（フィードバックの取り扱い）
            ユーザーが本アプリに関して提供した提案・意見・アイデア・改善要望等は、当社が無償かつ自由に使用できるものとし、ユーザーは一切の権利を主張しないものとします。

            ---

            ### 第13条（利用可能地域の制限）
            本アプリは日本国内での利用を前提として設計されており、日本国外での利用についてはユーザーの責任において行っていただきます。

            ---

            ### 第14条（準拠法・管轄）
            本規約は日本法を準拠法とし、本アプリに関して生じた紛争については、大分地方裁判所を第一審の専属的合意管轄裁判所とします。

            ---

            開発者：0kaka  
            メール：matassy0813@gmail.com  
            電話：070-1941-3184  
            所在地：日本・大分県  
            制定日：2025年7月31日
            """

        case .privacy:
            return """
            ## ShakeWith-U プライバシーポリシー
            0kaka（以下「当社」といいます）は、当社が提供するスマートフォンアプリ「ShakeWith-U」（以下「本アプリ」といいます）において、ユーザーの個人情報の取り扱いに関する方針を以下のとおり定めます。

            ---

            ### 第1条（収集する情報）

            本アプリでは、以下の情報を取得します：

            - アカウント情報：メールアドレス、ニックネーム、ユーザーID（UUID）、プロフィールURLなど  
            - 利用履歴：アプリの起動履歴、バッジ付与履歴、シェイクイベント、接触ログ、ストリーク、写真の送受信など  
            - デバイス情報：端末モデル、OSバージョン、言語設定、広告識別子（IDFA）など  
            - 位置情報：Shake時のロケーション（ユーザーの許可がある場合のみ）  
            - 通信ログ：Firebase認証ログ、クラッシュ情報、エラーログ  
            - その他：アプリ内で投稿・登録された自己紹介、ニックネーム、写真、コメントなどのコンテンツ

            ---

            ### 第2条（利用目的）

            取得した情報は、以下の目的で使用します：

            - 本アプリの提供・運営・改善のため  
            - ユーザー同士の交流機能（バッジ、写真、ストリーク等）の実現のため  
            - 本人確認、不正利用防止、セキュリティ確保のため  
            - お問い合わせ対応、サポート提供のため  
            - 利用状況分析、新機能の開発のため  
            - 広告表示および広告効果の測定のため（Google AdMob）  
            - キャンペーン・イベント・お知らせの通知（必要に応じて）

            ---

            ### 第3条（情報の保存期間）

            個人情報は、利用目的を達成するために必要な期間保存され、目的達成後は速やかに削除または匿名化されます。

            ---

            ### 第4条（サードパーティへの提供）

            当社は、以下の場合を除き、ユーザーの個人情報を第三者に提供しません：

            - ユーザー本人の同意がある場合  
            - 法令に基づく場合  
            - 人命や財産等の保護のために緊急性がある場合  
            - 公的機関からの正当な開示要請があった場合

            ---

            ### 第5条（サードパーティサービスの利用および情報の国際転送）

            本アプリでは、以下の外部サービスを利用しています。これに伴い、ユーザー情報が日本国外（例：米国）に設置されたサーバに転送・保存される場合があります：

            - Firebase Authentication / Firestore / Storage（Google LLC）  
            - AdMob（Google LLC）

            各サービスで取得される情報の範囲および利用目的については、各サービス提供元のプライバシーポリシーをご確認ください。

            ---

            ### 第6条（Cookieおよび解析ツール）

            本アプリでは、以下の解析技術を利用することがあります：

            - Firebase Analytics  
            - Apple App Analytics

            これらにより、ユーザーの操作状況や利用傾向を匿名で分析し、サービス改善や不正行為の検出に活用します。

            ---

            ### 第7条（広告およびトラッキング）

            当社は、Google AdMobを使用して広告を表示します。この際、広告識別子（IDFA）が使用され、ユーザーの行動に基づいた広告が配信される場合があります。

            ユーザーは、iOS端末の「設定 > プライバシーとセキュリティ > トラッキング」から、アプリごとにトラッキングの許可を管理できます。

            ---

            ### 第8条（ユーザーの権利）

            ユーザーは以下の権利を有します：

            - 登録情報の確認、訂正、削除を請求する権利  
            - アカウント削除の要請（アプリ内設定または下記連絡先より申請）  
            - 利用停止・利用制限・情報提供制限の申請

            上記の申請をご希望の場合は、「第11条 お問い合わせ先」までご連絡ください。

            ---

            ### 第9条（児童のプライバシー）

            本アプリは13歳未満の児童を対象としておらず、保護者の同意なしに個人情報を意図的に収集しません。万が一、13歳未満のユーザーから個人情報が収集されていたことが判明した場合は、速やかに削除いたします。

            ---

            ### 第10条（本ポリシーの改定）

            本ポリシーは、必要に応じて随時改定されます。改定後はアプリ内にて掲示し、掲示時点から効力を発揮します。

            ---

            ### 第11条（お問い合わせ先）

            個人情報の取り扱いやユーザー権利に関するお問い合わせは、以下までお願いいたします：

            開発者名：0kaka  
            メール：matassy0813@gmail.com  
            電話：070-1941-3184  
            所在地：日本・大分県

            制定日：2025年7月31日
            """

        }
    }
}

struct TermsAndPrivacyView: View {
    @Environment(\.dismiss) var dismiss
    let documentType: DocumentType

    var body: some View {
        NavigationView {
            ScrollView {
                VStack(alignment: .leading, spacing: 15) {
                    Markdown(documentType.content)
                        .padding()
                }
                .padding(.horizontal)
                .navigationTitle(documentType.title)
                .navigationBarTitleDisplayMode(.inline)
                .toolbar {
                    ToolbarItem(placement: .navigationBarLeading) {
                        Button("閉じる") {
                            dismiss()
                        }
                    }
                }
            }
        }
    }
}
